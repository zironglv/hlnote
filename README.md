# AI投研助手 📈

自动化获取多个中证指数股息率数据，生成专业分析报告并通过钉钉机器人分别推送。

## 🚀 功能特性

- **多指数支持**：同时分析多个中证指数数据
- **自动化数据获取**：每日定时从网络获取最新的Excel数据
- **智能数据分析**：计算关键指标（当前值、均值、极值、分位数等）
- **专业图表生成**：生成美观的股息率趋势图
- **个性化报告**：HTML格式的专业投资分析报告
- **钉钉独立推送**：每个指数生成独立报告并通过钉钉分别发送
- **容错机制**：单个指数失败不影响其他指数分析

## 📊 分析维度

- 当前股息率水平
- 15日历史均值对比
- 历史分位数分析
- 日内变化趋势
- 投资参考建议
- 多指数对比分析

## 🛠️ 技术架构

```
GitHub Actions → 多指数数据收集 → 并行数据处理 → 图表生成 → 钉钉推送
     ↓              ↓                ↓            ↓          ↓
  定时调度      Excel解析        指标计算     Matplotlib   Webhook
```

## 📁 项目结构

```
├── main_multi.py           # 多指数主程序入口
├── index_config.py         # 指数配置管理模块
├── multi_index_analyzer.py # 多指数分析核心逻辑
├── data_collector.py       # 数据收集模块
├── data_processor.py       # 数据处理模块
├── report_generator.py     # 报告生成模块
├── dingtalk_sender.py      # 钉钉发送模块
├── config.md               # 配置说明文档
└── .github/workflows/
    └── daily_report.yml    # GitHub Actions工作流
```

## ⚙️ 快速开始

### 1. 克隆项目
```bash
git clone <repository-url>
cd 自动化测试
```

### 2. 钉钉机器人配置
在钉钉群中添加自定义机器人，获取Webhook URL，并替换 `dingtalk_sender.py` 中的URL。

### 3. （可选）自定义指数配置
编辑 `index_config.py` 文件，添加或修改要分析的指数配置。

### 4. 推送代码
```bash
git add .
git commit -m "部署AI投研助手多指数版本"
git push origin main
```

## 🔧 配置详情

### 钉钉机器人配置
1. 在钉钉群中添加自定义机器人
2. 选择安全设置（建议使用关键词模式）
3. 添加关键词：`AI投研助手`、`股息率`、`报告`
4. 复制Webhook地址到代码中

详细配置说明请查看 [config.md](config.md)

## 📅 执行时间

默认每天UTC 23:00执行（北京时间次日早上7点）
可通过修改 `.github/workflows/daily_report.yml` 中的cron表达式调整执行时间。

支持的手动触发：在GitHub Actions页面点击"Run workflow"按钮。

## 📈 示例报告

每个指数将收到独立的报告，包含：
- 核心指标卡片
- 股息率趋势图
- 趋势分析
- 投资参考建议
- 总体分析总结报告

## 🔒 安全性

- 钉钉Webhook URL可在代码中配置
- 支持钉钉机器人安全设置（关键词/IP白名单）
- 敏感配置集中管理

## 🤖 后续计划

- [x] 多指数支持
- [x] 钉钉机器人推送
- [ ] 集成AI观点分析
- [ ] 网络舆情爬取
- [ ] 智能加仓/减仓建议
- [ ] 更多技术指标
- [ ] 移动端推送通知

## 📞 支持

如有问题请提交Issue或联系维护者。

---
*AI投研助手 - 让投资更有依据*